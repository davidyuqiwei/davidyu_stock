19/01/27 14:52:06 WARN Utils: Your hostname, VM_0_11_centos resolves to a loopback address: 127.0.0.1; using 172.16.0.11 instead (on interface eth0)
19/01/27 14:52:06 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
19/01/27 14:52:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "ERROR".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://172.16.0.11:4041
Spark context available as 'sc' (master = local[*], app id = local-1548571936467).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.4.0
      /_/
         
Using Scala version 2.11.12 (OpenJDK 64-Bit Server VM, Java 1.8.0_191)
Type in expressions to have them evaluated.
Type :help for more information.

scala> System.out.println(System.getProperty("user.dir"))
/home/davidyu/stock/scripts/davidyu_stock/scripts/download/day_history

scala> val work_dir=System.getProperty("user.dir")
work_dir: String = /home/davidyu/stock/scripts/davidyu_stock/scripts/download/day_history

scala> val data_file="file://"+work_dir+"/all.csv"
data_file: String = file:///home/davidyu/stock/scripts/davidyu_stock/scripts/download/day_history/all.csv

scala> 

scala> val sqlContext = new org.apache.spark.sql.hive.HiveContext(sc)
warning: there was one deprecation warning; re-run with -deprecation for details
sqlContext: org.apache.spark.sql.hive.HiveContext = org.apache.spark.sql.hive.HiveContext@4cb87009

scala> 

scala> val csv_data = spark.read.csv(data_file)
csv_data: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 6 more fields]

scala> csv_data.show()
+----------+----+----+----+----+-----------+----+------+
|       _c0| _c1| _c2| _c3| _c4|        _c5| _c6|   _c7|
+----------+----+----+----+----+-----------+----+------+
|2009-01-05|3.52|3.44|3.46|3.51| 94231900.0|3.14|000001|
|2009-01-06|3.77|3.52|3.54|3.73|175656138.0|3.33|000001|
|2009-01-07|3.76|3.61|3.69|3.61|169194800.0|3.23|000001|
|2009-01-08|3.53|3.44|3.53|3.47|108538435.0|3.11|000001|
|2009-01-09|3.59|3.47|3.47|3.56|167120348.0|3.19|000001|
|2009-01-12|3.65| 3.5|3.54|3.57|114872025.0|3.19|000001|
|2009-01-13|3.48|3.21|3.21|3.43|478506152.0|3.06|000001|
|2009-01-14|3.71|3.36|3.36|3.69|211596982.0| 3.3|000001|
|2009-01-15|3.83|3.61|3.62|3.73|247453582.0|3.33|000001|
|2009-01-16|3.96|3.74|3.74|3.84|183685117.0|3.44|000001|
|2009-01-19|4.11|3.85|3.85|4.02|258877869.0| 3.6|000001|
|2009-01-20|4.12|3.99| 4.0|4.11|130768055.0|3.68|000001|
|2009-01-21|4.41|3.98|4.03|4.26|227945587.0|3.82|000001|
|2009-01-22|4.34|4.12|4.27|4.26|129782374.0|3.82|000001|
|2009-01-23|4.31|4.19|4.19|4.21| 95582604.0|3.77|000001|
|2009-02-02|4.34|4.16|4.25|4.22| 91169107.0|3.77|000001|
|2009-02-03|4.36| 4.2|4.22|4.32|101921666.0|3.87|000001|
|2009-02-04|4.76|4.35|4.35|4.72|149562314.0|4.22|000001|
|2009-02-05|4.77|4.57|4.73|4.63|103245505.0|4.14|000001|
|2009-02-06|4.86|4.64|4.64|4.77| 89772510.0|4.27|000001|
+----------+----+----+----+----+-----------+----+------+
only showing top 20 rows


scala> csv_data.createOrReplaceTempView("history_day")

scala> sqlContext.sql("insert into table stock_dev.day_history_insert s elect * from history_day")
19/01/27 14:52:30 ERROR ObjectStore: Version information found in metastore differs 3.1.0 from expected schema version 1.2.0. Schema verififcation is disabled hive.metastore.schema.verification so setting version.
[Stage 2:>                                                          (0 + 2) / 3][Stage 2:===================>                                       (1 + 2) / 3][Stage 2:=======================================>                   (2 + 1) / 3]                                                                                res3: org.apache.spark.sql.DataFrame = []

scala> 

scala> //csv_data.toDF().insertInto("day_history")

scala> 

scala> 

scala> 

scala> //select max(stock_date) as date from stock_dev.day_history;

scala> 

scala> 

scala> :quit
